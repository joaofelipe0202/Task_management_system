@model ICollection<Task_Managment_System.Models.ProjectTask>

<h2>@ViewBag.Title</h2>

<main>
    <section>
        <ul class="list-group">
            @{
                if (Model.Count() > 0)
                {
                    foreach (var item in Model)
                    {
                        string levelClass = null;

                        switch (item.Priority)
                        {
                            case Task_Managment_System.Models.Priority.Urgent:
                                levelClass = " list-group-item-danger";
                                break;
                            case Task_Managment_System.Models.Priority.High:
                                levelClass = " list-group-item-waring";
                                break;
                            case Task_Managment_System.Models.Priority.Average:
                                levelClass = " list-group-item-info";
                                break;
                        }

                        <li class="list-group-item @levelClass" onclick="handleToggleCompleteForTask(event,@item.Id)">
                            @Html.CheckBox("check", item.Complete, new { @class = "form-check-input me-1" })
                            <div>@item.Title</div>
                            <div>Manager: @item.Manager.UserName</div>
                            <div>Percentage: @item.PercentageCompleted%</div>
                            <div>Priority: @item.Priority</div>
                        </li>
                    }
                }
            }
        </ul>

    </section>
</main>

<script>

    function handleToggleCompleteForTask(event, taskId) {
        if (event.target.tagName === "INPUT") {
            $.ajax(
                {
                    type: 'POST',
                    url: "@Url.Action("UpdateCompleteStatusForTask", "ProjectManagers")/" + taskId,
                    data: {
                        isChecked: event.target.checked
                    },
                    success: function (result) {
                        //test
                        console.log(result.status);
                    },
                    error: function (err) {
                        //test
                        alert(err.responseText);
                    }

                }
            )
        }
    }

</script>



